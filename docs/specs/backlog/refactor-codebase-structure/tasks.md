# tasks.md

## Codebase Refactor Tasks

This document outlines the detailed tasks required to refactor the MadraXis codebase according to the new architectural guidelines. Tasks are grouped by category and include estimated story points (SP) for complexity.

### 1. Project Setup & Configuration (20 SP)

*   [ ] **Backend/Infra:**
    *   [ ] Review existing Supabase schema and identify potential impacts of refactor. (5 SP)
    *   [ ] Ensure Supabase client configuration is aligned with new domain structure. (5 SP)
*   [ ] **Frontend:**
    *   [ ] Update `tsconfig.json` to include new path aliases (`@ui`, `@domains`, `@lib`, `@context`, `@types`). (5 SP)
    *   [ ] Configure ESLint and Prettier to enforce new coding standards and architectural patterns. (5 SP)

### 2. Core UI Components (src/ui) Refactoring (80 SP)

*   **Atoms (30 SP)**
    *   [ ] Refactor `Button` component to `src/ui/atoms/Button/Button.tsx`. (5 SP)
        *   [ ] Create `Button.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `Button.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `Button`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `Avatar` component to `src/ui/atoms/Avatar/Avatar.tsx`. (5 SP)
        *   [ ] Create `Avatar.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `Avatar.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `Avatar`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `Icon` component to `src/ui/atoms/Icon/Icon.tsx`. (5 SP)
        *   [ ] Create `Icon.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `Icon.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `Icon`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `Input` component to `src/ui/atoms/Input/Input.tsx`. (5 SP)
        *   [ ] Create `Input.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `Input.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `Input`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `Typography` component to `src/ui/atoms/Typography/Typography.tsx`. (5 SP)
        *   [ ] Create `Typography.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `Typography.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `Typography`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `LoadingSpinner` component to `src/ui/atoms/LoadingSpinner/LoadingSpinner.tsx`. (3 SP)
        *   [ ] Create `LoadingSpinner.test.tsx` for unit tests. (3 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `BackgroundPattern` component to `src/ui/atoms/BackgroundPattern/BackgroundPattern.tsx`. (3 SP)
        *   [ ] Create `BackgroundPattern.test.tsx` for unit tests. (3 SP)
        *   [ ] Create `BackgroundPattern.stories.tsx` for Storybook. (3 SP)
        *   [ ] Create `README.md` for `BackgroundPattern`. (1 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
*   **Molecules (30 SP)**
    *   [ ] Refactor `Card` component to `src/ui/molecules/Card/Card.tsx`. (5 SP)
        *   [ ] Create `Card.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `Card.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `Card`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `ListItem` component to `src/ui/molecules/ListItem/ListItem.tsx`. (5 SP)
        *   [ ] Create `ListItem.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `ListItem.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `ListItem`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `NotificationItem` component to `src/ui/molecules/NotificationItem/NotificationItem.tsx`. (5 SP)
        *   [ ] Create `NotificationItem.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `NotificationItem.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `NotificationItem`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `ProgressBar` component to `src/ui/molecules/ProgressBar/ProgressBar.tsx`. (5 SP)
        *   [ ] Create `ProgressBar.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `ProgressBar.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `ProgressBar`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `QuickAction` component to `src/ui/molecules/QuickAction/QuickAction.tsx`. (5 SP)
        *   [ ] Create `QuickAction.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `QuickAction.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `QuickAction`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `StudentSelectionList` component to `src/ui/molecules/StudentSelectionList/StudentSelectionList.tsx`. (5 SP)
        *   [ ] Create `StudentSelectionList.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `StudentSelectionList.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `StudentSelectionList`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `BulkActionBar` component to `src/ui/molecules/BulkActionBar/BulkActionBar.tsx`. (5 SP)
        *   [ ] Create `BulkActionBar.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `BulkActionBar.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `BulkActionBar`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `BreadcrumbNavigation` component to `src/ui/molecules/BreadcrumbNavigation/BreadcrumbNavigation.tsx`. (3 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `EmptyState` component to `src/ui/molecules/EmptyState/EmptyState.tsx`. (3 SP)
        *   [ ] Create `EmptyState.test.tsx` for unit tests. (3 SP)
    *   [ ] Refactor `ErrorMessage` component to `src/ui/molecules/ErrorMessage/ErrorMessage.tsx`. (3 SP)
    *   [ ] Refactor `SkeletonCard` component to `src/ui/molecules/SkeletonCard/SkeletonCard.tsx`. (3 SP)
        *   [ ] Create `SkeletonCard.test.tsx` for unit tests. (3 SP)
    *   [ ] Refactor `LogoutButton` component to `src/ui/molecules/LogoutButton.tsx`. (2 SP)
*   **Organisms (20 SP)**
    *   [ ] Refactor `Header` component to `src/ui/organisms/Header/Header.tsx`. (5 SP)
        *   [ ] Create `Header.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `Header.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `Header`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `Modal` component to `src/ui/organisms/Modal/Modal.tsx`. (5 SP)
        *   [ ] Create `Modal.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `Modal.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `Modal`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `NavigationPanel` component to `src/ui/organisms/NavigationPanel/NavigationPanel.tsx`. (5 SP)
        *   [ ] Create `NavigationPanel.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `NavigationPanel.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `NavigationPanel`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `TabBar` component to `src/ui/organisms/TabBar/TabBar.tsx`. (5 SP)
        *   [ ] Create `TabBar.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `TabBar.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `TabBar`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `AddStudentsToClassModal` component to `src/ui/organisms/AddStudentsToClassModal/AddStudentsToClassModal.tsx`. (5 SP)
        *   [ ] Create `AddStudentsToClassModal.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `AddStudentsToClassModal.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `AddStudentsToClassModal`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `DashboardContent` component to `src/ui/organisms/DashboardContent/DashboardContent.tsx`. (3 SP)
        *   [ ] Create `README.md` for `DashboardContent`. (1 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `ErrorBoundary` component to `src/ui/organisms/ErrorBoundary/ErrorBoundary.tsx`. (3 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `AnimatedSplashScreen` component to `src/ui/organisms/AnimatedSplashScreen.tsx`. (2 SP)
    *   [ ] Refactor `AuthForm` component to `src/ui/organisms/AuthForm.tsx`. (2 SP)
    *   [ ] Refactor `ClassFormModal` component to `src/ui/organisms/ClassFormModal.tsx`. (2 SP)
    *   [ ] Refactor `StudentBoardingInfoModal` component to `src/ui/organisms/StudentBoardingInfoModal.tsx`. (2 SP)
    *   [ ] Refactor `StudentCommunicationModal` component to `src/ui/organisms/StudentCommunicationModal.tsx`. (2 SP)
    *   [ ] Refactor `StudentIncidentReportModal` component to `src/ui/organisms/StudentIncidentReportModal.tsx`. (2 SP)
    *   [ ] Refactor `SubjectManager` component to `src/ui/organisms/SubjectManager.tsx`. (2 SP)
    *   [ ] Refactor `TeacherBoardingInfoModal` component to `src/ui/organisms/TeacherBoardingInfoModal.tsx`. (2 SP)
    *   [ ] Refactor `TeacherCommunicationModal` component to `src/ui/organisms/TeacherCommunicationModal.tsx`. (2 SP)
    *   [ ] Refactor `TeacherIncidentReportModal` component to `src/ui/organisms/TeacherIncidentReportModal.tsx`. (2 SP)
    *   [ ] Refactor `TeacherNotificationPanel` component to `src/ui/organisms/TeacherNotificationPanel.tsx`. (2 SP)
    *   [ ] Refactor `TeacherProfileView` component to `src/ui/organisms/TeacherProfileView.tsx`. (2 SP)
*   **Templates (20 SP)**
    *   [ ] Refactor `DashboardTemplate` to `src/ui/templates/DashboardTemplate/DashboardTemplate.tsx`. (5 SP)
        *   [ ] Create `DashboardTemplate.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `DashboardTemplate.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `DashboardTemplate`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `FormTemplate` to `src/ui/templates/FormTemplate/FormTemplate.tsx`. (5 SP)
        *   [ ] Create `FormTemplate.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `FormTemplate.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `FormTemplate`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `ModalTemplate` to `src/ui/templates/ModalTemplate/ModalTemplate.tsx`. (5 SP)
        *   [ ] Create `ModalTemplate.test.tsx` for unit tests. (5 SP)
        *   [ ] Create `ModalTemplate.stories.tsx` for Storybook. (5 SP)
        *   [ ] Create `README.md` for `ModalTemplate`. (2 SP)
        *   [ ] Create `index.ts` for barrel export. (1 SP)
    *   [ ] Refactor `AddStudentTemplate` to `src/ui/templates/AddStudentTemplate.tsx`. (3 SP)
    *   [ ] Refactor `AntiBullyingResourcesTemplate` to `src/ui/templates/AntiBullyingResourcesTemplate.tsx`. (3 SP)
    *   [ ] Refactor `CCTVAccessRequestTemplate` to `src/ui/templates/CCTVAccessRequestTemplate.tsx`. (3 SP)
    *   [ ] Refactor `ClassDetailTemplate` to `src/ui/templates/ClassDetailTemplate.tsx`. (3 SP)
    *   [ ] Refactor `ClassDetailView` to `src/ui/templates/ClassDetailView.tsx`. (3 SP)
    *   [ ] Refactor `ClassReportsTemplate` to `src/ui/templates/ClassReportsTemplate.tsx`. (3 SP)
    *   [ ] Refactor `ClassScheduleTemplate` to `src/ui/templates/ClassScheduleTemplate.tsx`. (3 SP)
    *   [ ] Refactor `ClassStudentsTemplate` to `src/ui/templates/ClassStudentsTemplate.tsx`. (3 SP)
    *   [ ] Refactor `ClassesListTemplate` to `src/ui/templates/ClassesListTemplate.tsx`. (3 SP)
    *   [ ] Refactor `ParentIncidentReportTemplate` to `src/ui/templates/ParentIncidentReportTemplate.tsx`. (3 SP)
    *   [ ] Refactor `StudentAntiBullyingTemplate` to `src/ui/templates/StudentAntiBullyingTemplate.tsx`. (3 SP)
    *   [ ] Refactor `StudentDetailTemplate` to `src/ui/templates/StudentDetailTemplate.tsx`. (3 SP)
    *   [ ] Refactor `StudentIncidentReportTemplate` to `src/ui/templates/StudentIncidentReportTemplate.tsx`. (3 SP)
    *   [ ] Refactor `StudentsListTemplate` to `src/ui/templates/StudentsListTemplate.tsx`. (3 SP)

### 3. Domain Logic (src/domains) Refactoring (100 SP)

*   **Class Domain (30 SP)**
    *   [ ] Create `src/domains/class/api.ts` for Supabase interactions. (10 SP)
    *   [ ] Create `src/domains/class/hooks.ts` for class-related React hooks. (10 SP)
    *   [ ] Create `src/domains/class/store.ts` for global class state (Zustand). (5 SP)
    *   [ ] Create `src/domains/class/types.ts` for class-related types. (3 SP)
    *   [ ] Create `src/domains/class/Class.unit.test.ts`. (5 SP)
    *   [ ] Create `src/domains/class/index.ts` for barrel export. (2 SP)
    *   [ ] Migrate existing class-related service logic from `src/services/classService.ts` and `src/services/class/` to `src/domains/class/api.ts`. (15 SP)
*   **Incidents Domain (20 SP)**
    *   [ ] Create `src/domains/incidents/api.ts` for Supabase interactions. (7 SP)
    *   [ ] Create `src/domains/incidents/hooks.ts` for incident-related React hooks. (7 SP)
    *   [ ] Create `src/domains/incidents/types.ts` for incident-related types. (3 SP)
    *   [ ] Create `src/domains/incidents/index.ts` for barrel export. (2 SP)
    *   [ ] Migrate existing incident-related service logic from `src/services/incidents.ts` to `src/domains/incidents/api.ts`. (10 SP)
*   **Users Domain (20 SP)**
    *   [ ] Create `src/domains/users/api.ts` for Supabase interactions. (7 SP)
    *   [ ] Create `src/domains/users/hooks.ts` for user-related React hooks. (7 SP)
    *   [ ] Create `src/domains/users/types.ts` for user-related types. (3 SP)
    *   [ ] Create `src/domains/users/index.ts` for barrel export. (2 SP)
    *   [ ] Migrate existing user-related service logic from `src/services/users.ts` to `src/domains/users/api.ts`. (10 SP)
*   **Subjects Domain (20 SP)**
    *   [ ] Create `src/domains/subjects/api.ts` for Supabase interactions. (7 SP)
    *   [ ] Create `src/domains/subjects/hooks.ts` for subject-related React hooks. (7 SP)
    *   [ ] Create `src/domains/subjects/types.ts` for subject-related types. (3 SP)
    *   [ ] Create `src/domains/subjects/index.ts` for barrel export. (2 SP)
    *   [ ] Migrate existing subject-related service logic from `src/services/subjectService.ts` to `src/domains/subjects/api.ts`. (10 SP)
*   **Dashboard Domain (10 SP)**
    *   [ ] Create `src/domains/dashboard/api.ts` for Supabase interactions. (5 SP)
    *   [ ] Create `src/domains/dashboard/hooks.ts` for dashboard-related React hooks. (5 SP)
    *   [ ] Create `src/domains/dashboard/types.ts` for dashboard-related types. (2 SP)
    *   [ ] Create `src/domains/dashboard/index.ts` for barrel export. (1 SP)
    *   [ ] Migrate existing dashboard-related service logic from `src/services/dashboard.ts` to `src/domains/dashboard/api.ts`. (5 SP)
*   **Schools Domain (10 SP)**
    *   [ ] Create `src/domains/schools/api.ts` for Supabase interactions. (5 SP)
    *   [ ] Create `src/domains/schools/hooks.ts` for school-related React hooks. (5 SP)
    *   [ ] Create `src/domains/schools/types.ts` for school-related types. (2 SP)
    *   [ ] Create `src/domains/schools/index.ts` for barrel export. (1 SP)
    *   [ ] Migrate existing school-related service logic from `src/services/schools.ts` to `src/domains/schools/api.ts`. (5 SP)

### 4. Routing and Navigation (app/) Refactoring (60 SP)

*   [ ] **Authentication Flow (20 SP)**
    *   [ ] Migrate `app/(auth)/login.tsx` to `app/(auth)/login/screen.tsx`. (5 SP)
        *   [ ] Create `app/(auth)/login/model.ts`. (3 SP)
        *   [ ] Create `app/(auth)/login/ui.tsx`. (3 SP)
        *   [ ] Create `app/(auth)/login/store.ts` (optional, if local state needed). (2 SP)
        *   [ ] Create `app/(auth)/login/Login.integration.test.tsx`. (5 SP)
        *   [ ] Create `app/(auth)/login/Login.stories.tsx`. (3 SP)
        *   [ ] Create `app/(auth)/login/index.ts`. (1 SP)
    *   [ ] Migrate `app/(auth)/reset-password.tsx` to `app/(auth)/reset-password/screen.tsx`. (5 SP)
        *   [ ] Create `app/(auth)/reset-password/model.ts`. (3 SP)
        *   [ ] Create `app/(auth)/reset-password/ui.tsx`. (3 SP)
        *   [ ] Create `app/(auth)/reset-password/index.ts`. (1 SP)
*   [ ] **Student Flow (20 SP)**
    *   [ ] Migrate `app/(student)/dashboard.tsx` to `app/(student)/dashboard/screen.tsx`. (5 SP)
        *   [ ] Create `app/(student)/dashboard/widgets/ScoreCard.tsx`. (3 SP)
        *   [ ] Create `app/(student)/dashboard/widgets/ScoreCard.test.tsx`. (3 SP)
        *   [ ] Create `app/(student)/dashboard/widgets/ScoreCard.stories.tsx`. (3 SP)
        *   [ ] Create `app/(student)/dashboard/Dashboard.integration.test.tsx`. (5 SP)
        *   [ ] Create `app/(student)/dashboard/index.ts`. (1 SP)
    *   [ ] Migrate `app/(student)/quran-progress.tsx` to `app/(student)/quran-progress/screen.tsx`. (5 SP)
        *   [ ] Create `app/(student)/quran-progress/model.ts`. (3 SP)
        *   [ ] Create `app/(student)/quran-progress/ui.tsx`. (3 SP)
        *   [ ] Create `app/(student)/quran-progress/index.ts`. (1 SP)
*   [ ] **Teacher Flow (20 SP)**
    *   [ ] Migrate `app/(teacher)/class/[id]/add-students.tsx` to `app/(teacher)/class/[id]/add-students/screen.tsx`. (5 SP)
        *   [ ] Create `app/(teacher)/class/[id]/add-students/model.ts`. (3 SP)
        *   [ ] Create `app/(teacher)/class/[id]/add-students/ui.tsx`. (3 SP)
        *   [ ] Create `app/(teacher)/class/[id]/add-students/store.ts`. (2 SP)
        *   [ ] Create `app/(teacher)/class/[id]/add-students/AddStudents.integration.test.tsx`. (5 SP)
        *   [ ] Create `app/(teacher)/class/[id]/add-students/AddStudents.e2e.spec.ts`. (5 SP)
        *   [ ] Create `app/(teacher)/class/[id]/add-students/index.ts`. (1 SP)
    *   [ ] Migrate `app/(teacher)/class/[id]/schedule/index.tsx` to `app/(teacher)/class/[id]/schedule/screen.tsx`. (5 SP)
        *   [ ] Create `app/(teacher)/class/[id]/schedule/model.ts`. (3 SP)
        *   [ ] Create `app/(teacher)/class/[id]/schedule/ui.tsx`. (3 SP)
        *   [ ] Create `app/(teacher)/class/[id]/schedule/index.ts`. (1 SP)
    *   [ ] Migrate `app/(teacher)/class/[id]/reports/index.tsx` to `app/(teacher)/class/[id]/reports/screen.tsx`. (5 SP)
        *   [ ] Create `app/(teacher)/class/[id]/reports/model.ts`. (3 SP)
        *   [ ] Create `app/(teacher)/class/[id]/reports/ui.tsx`. (3 SP)
        *   [ ] Create `app/(teacher)/class/[id]/reports/index.ts`. (1 SP)

### 5. Shared Utilities & Helpers (src/lib) Refactoring (30 SP)

*   **Hooks (10 SP)**
    *   [ ] Migrate `useAuth.ts` to `src/lib/hooks/useAuth.ts`. (3 SP)
    *   [ ] Migrate `useClassStudentBreakdown.ts` to `src/lib/hooks/useClassStudentBreakdown.ts`. (3 SP)
    *   [ ] Migrate `useClassStudentsSubscription.ts` to `src/lib/hooks/useClassStudentsSubscription.ts`. (3 SP)
    *   [ ] Migrate `useNavigationGuards.ts` to `src/lib/hooks/useNavigationGuards.ts`. (3 SP)
    *   [ ] Migrate `useNavigationHistory.ts` to `src/lib/hooks/useNavigationHistory.ts`. (3 SP)
    *   [ ] Migrate `useStudentCountSubscription.ts` to `src/lib/hooks/useStudentCountSubscription.ts`. (3 SP)
    *   [ ] Create `src/lib/hooks/usePrevious.ts`. (2 SP)
    *   [ ] Create `src/lib/hooks/useDebounce.ts`. (2 SP)
*   **Utils (10 SP)**
    *   [ ] Migrate `logger.ts` to `src/lib/utils/logger.ts`. (3 SP)
    *   [ ] Migrate `dateHelpers.ts` to `src/lib/utils/date.ts`. (3 SP)
    *   [ ] Migrate `idConversion.ts` to `src/lib/utils/idConversion.ts`. (3 SP)
    *   [ ] Migrate `linking.ts` to `src/lib/utils/linking.ts`. (3 SP)
    *   [ ] Migrate `navigationGuard.ts` to `src/lib/utils/navigationGuard.ts`. (3 SP)
    *   [ ] Migrate `responsive.ts` to `src/lib/utils/responsive.ts`. (3 SP)
    *   [ ] Migrate `retry.ts` to `src/lib/utils/retry.ts`. (3 SP)
    *   [ ] Migrate `sanitization.ts` to `src/lib/utils/sanitization.ts`. (3 SP)
    *   [ ] Migrate `styleHelpers.ts` to `src/lib/utils/styleHelpers.ts`. (3 SP)
    *   [ ] Migrate `supabase.ts` to `src/lib/utils/supabase.ts`. (3 SP)
    *   [ ] Migrate `svgPatterns.ts` to `src/lib/utils/svgPatterns.ts`. (3 SP)
    *   [ ] Migrate `typeHelpers.ts` to `src/lib/utils/typeHelpers.ts`. (3 SP)
    *   [ ] Migrate `backgroundPattern.ts` to `src/lib/utils/backgroundPattern.ts`. (3 SP)
*   **Constants (5 SP)**
    *   [ ] Create `src/lib/constants/roleCapabilities.ts` for RBAC. (5 SP)
*   **Tests (5 SP)**
    *   [ ] Create `src/lib/tests/renderWithProviders.tsx`. (3 SP)
    *   [ ] Create `src/lib/tests/navigationMock.ts`. (2 SP)

### 6. Global State & Context (src/context) Refactoring (15 SP)

*   [ ] Migrate `AuthContext.tsx` to `src/context/AuthContext/AuthProvider.tsx`. (5 SP)
    *   [ ] Create `src/context/AuthContext/useAuth.ts`. (3 SP)
    *   [ ] Create `src/context/AuthContext/AuthContext.test.tsx`. (3 SP)
    *   [ ] Create `src/context/AuthContext/index.ts`. (1 SP)
*   [ ] Migrate `ThemeContext.tsx` to `src/context/ThemeContext/ThemeContext.tsx`. (5 SP)
    *   [ ] Create `src/context/ThemeContext/index.ts`. (1 SP)
*   [ ] Migrate `NavigationHistoryContext.tsx` to `src/context/NavigationHistoryContext/NavigationHistoryContext.tsx`. (5 SP)
    *   [ ] Create `src/context/NavigationHistoryContext/index.ts`. (1 SP)

### 7. Global Type Declarations (src/types) Refactoring (10 SP)

*   [ ] Consolidate all global type declarations into `src/types/index.ts`. (10 SP)
    *   [ ] Migrate `class.ts` types.
    *   [ ] Migrate `dashboard.ts` types.
    *   [ ] Migrate `database.ts` types.
    *   [ ] Migrate `exports.ts` types.
    *   [ ] Migrate `student.ts` types.

### 8. Testing Infrastructure (20 SP)

*   [ ] Configure Jest for new project structure. (5 SP)
    *   [ ] Update `jest.setup.js` to `jest/setup.ts`.
    *   [ ] Create `jest/mocks/fileMock.js`.
    *   [ ] Create `jest/mocks/svgMock.js`.
*   [ ] Configure Storybook for new UI component structure. (5 SP)
    *   [ ] Create `.storybook/main.js`.
    *   [ ] Create `.storybook/preview.js`.
*   [ ] Set up E2E testing with Detox/Playwright. (10 SP)
    *   [ ] Create `e2e/add-students-flow.spec.ts` as an example.

### 9. Cleanup & Verification (15 SP)

*   [ ] Remove old component files and directories after migration. (5 SP)
*   [ ] Remove old service files and directories after migration. (5 SP)
*   [ ] Run all tests (unit, integration, e2e) to ensure full functionality. (5 SP)
*   [ ] Perform a comprehensive code review to ensure adherence to new architecture and coding standards. (5 SP)
*   [ ] Update `README.md` with new project structure and development guidelines. (5 SP)

### Total Estimated Story Points: ~360 SP