## Existing Codebase Structure
```
. ğŸ“‚ MadraXis
â”œâ”€â”€ ğŸ“„ DEEP_LINKING_GUIDE.md
â”œâ”€â”€ ğŸ“„ README.md
â””â”€â”€ ğŸ“‚ android/
â””â”€â”€ ğŸ“‚ app/
â”œâ”€â”€ ğŸ“„ app.config.js
â”‚  â””â”€â”€ ğŸ“‚ (auth)/
â”‚    â”œâ”€â”€ ğŸ“„ _layout.tsx
â”‚    â”œâ”€â”€ ğŸ“„ login.tsx
â”‚    â”œâ”€â”€ ğŸ“„ reset-password.tsx
â”‚  â””â”€â”€ ğŸ“‚ (management)/
â”‚    â”œâ”€â”€ ğŸ“„ _layout.tsx
â”‚    â”œâ”€â”€ ğŸ“„ dashboard.tsx
â”‚    â”œâ”€â”€ ğŸ“„ index.tsx
â”‚    â”œâ”€â”€ ğŸ“„ setup.tsx
â”‚    â”œâ”€â”€ ğŸ“„ user-management.tsx
â”‚  â””â”€â”€ ğŸ“‚ (parent)/
â”‚    â”œâ”€â”€ ğŸ“„ _layout.tsx
â”‚    â”œâ”€â”€ ğŸ“„ anti-bullying.tsx
â”‚    â”œâ”€â”€ ğŸ“„ cctv-request.tsx
â”‚    â”œâ”€â”€ ğŸ“„ dashboard.tsx
â”‚    â”œâ”€â”€ ğŸ“„ incident-report.tsx
â”‚    â”œâ”€â”€ ğŸ“„ index.tsx
â”‚  â””â”€â”€ ğŸ“‚ (student)/
â”‚    â”œâ”€â”€ ğŸ“„ _layout.tsx
â”‚    â”œâ”€â”€ ğŸ“„ anti-bullying.tsx
â”‚    â”œâ”€â”€ ğŸ“„ boarding-info.tsx
â”‚    â”œâ”€â”€ ğŸ“„ dashboard.tsx
â”‚    â”œâ”€â”€ ğŸ“„ incident-report.tsx
â”‚    â”œâ”€â”€ ğŸ“„ index.tsx
â”‚    â”œâ”€â”€ ğŸ“„ quran-progress.tsx
â”‚    â”œâ”€â”€ ğŸ“„ schedule.tsx
â”‚  â””â”€â”€ ğŸ“‚ (teacher)/
â”‚    â”œâ”€â”€ ğŸ“„ _layout.tsx
â”‚    â””â”€â”€ ğŸ“‚ class/
â”‚      â””â”€â”€ ğŸ“‚ [id]/
â”‚        â”œâ”€â”€ ğŸ“„ add-students.tsx
â”‚        â”œâ”€â”€ ğŸ“„ index.tsx
â”‚        â””â”€â”€ ğŸ“‚ reports/
â”‚          â”œâ”€â”€ ğŸ“„ index.tsx
â”‚        â””â”€â”€ ğŸ“‚ schedule/
â”‚          â”œâ”€â”€ ğŸ“„ index.tsx
â”‚        â””â”€â”€ ğŸ“‚ students/
â”‚          â”œâ”€â”€ ğŸ“„ index.tsx
â”‚      â”œâ”€â”€ ğŸ“„ index.tsx
â”‚    â”œâ”€â”€ ğŸ“„ dashboard.tsx
â”‚    â”œâ”€â”€ ğŸ“„ index.tsx
â”‚    â””â”€â”€ ğŸ“‚ students/
â”‚      â”œâ”€â”€ ğŸ“„ [id].tsx
â”‚      â”œâ”€â”€ ğŸ“„ add.tsx
â”‚      â”œâ”€â”€ ğŸ“„ index.tsx
â”‚  â”œâ”€â”€ ğŸ“„ _layout.tsx
â”‚  â”œâ”€â”€ ğŸ“„ index.tsx
â””â”€â”€ ğŸ“‚ assets/
â”‚  â””â”€â”€ ğŸ“‚ animations/
â”‚    â”œâ”€â”€ ğŸ“„ splash.json
â”‚    â”œâ”€â”€ ğŸ“„ splash_screen.riv
â”‚  â””â”€â”€ ğŸ“‚ fonts/
â”‚    â”œâ”€â”€ ğŸ“„ SpaceMono-Regular.ttf
â”‚  â””â”€â”€ ğŸ“‚ images/
â”‚    â”œâ”€â”€ ğŸ“„ adaptive-icon.png
â”‚    â”œâ”€â”€ ğŸ“„ favicon.png
â”‚    â”œâ”€â”€ ğŸ“„ icon.png
â”‚    â”œâ”€â”€ ğŸ“„ partial-react-logo.png
â”‚    â”œâ”€â”€ ğŸ“„ react-logo.png
â”‚    â”œâ”€â”€ ğŸ“„ react-logo@2x.png
â”‚    â”œâ”€â”€ ğŸ“„ react-logo@3x.png
â”‚    â”œâ”€â”€ ğŸ“„ splash.png
â”‚    â””â”€â”€ ğŸ“‚ svg/
â”‚      â”œâ”€â”€ ğŸ“„ logo.svg
â”‚      â””â”€â”€ ğŸ“‚ onboarding/
â”‚        â”œâ”€â”€ ğŸ“„ onboarding1.svg
â”‚        â”œâ”€â”€ ğŸ“„ onboarding2.svg
â”‚        â”œâ”€â”€ ğŸ“„ onboarding3.svg
â”‚      â”œâ”€â”€ ğŸ“„ zaid_logo.svg
â”‚    â”œâ”€â”€ ğŸ“„ zaid_logo.png
â”œâ”€â”€ ğŸ“„ babel.config.js
â”œâ”€â”€ ğŸ“„ bun.lock
â””â”€â”€ ğŸ“‚ docs/
â”‚  â””â”€â”€ ğŸ“‚ management/
â”‚    â”œâ”€â”€ ğŸ“„ prd-management-overview.md
â”‚  â””â”€â”€ ğŸ“‚ parents/
â”‚    â”œâ”€â”€ ğŸ“„ prd-parents-school-edition.md
â”‚  â””â”€â”€ ğŸ“‚ specs/
â”‚    â””â”€â”€ ğŸ“‚ completed/
â”‚      â””â”€â”€ ğŸ“‚ class-subject-crud/
â”‚        â”œâ”€â”€ ğŸ“„ design.md
â”‚        â”œâ”€â”€ ğŸ“„ refactor_tasks.md
â”‚        â”œâ”€â”€ ğŸ“„ requirements.md
â”‚        â”œâ”€â”€ ğŸ“„ tasks.md
â”‚      â””â”€â”€ ğŸ“‚ consistent-design-system/
â”‚        â”œâ”€â”€ ğŸ“„ COMMIT_STRATEGY.md
â”‚        â”œâ”€â”€ ğŸ“„ component-documentation.md
â”‚        â”œâ”€â”€ ğŸ“„ design.md
â”‚        â”œâ”€â”€ ğŸ“„ migration-guide.md
â”‚        â”œâ”€â”€ ğŸ“„ project_discovery.md
â”‚        â”œâ”€â”€ ğŸ“„ requirements.md
â”‚        â”œâ”€â”€ ğŸ“„ tasks.md
â”‚      â””â”€â”€ ğŸ“‚ refactor-directory-structure/
â”‚        â”œâ”€â”€ ğŸ“„ REMAINING_WORK.md
â”‚        â”œâ”€â”€ ğŸ“„ design.md
â”‚        â”œâ”€â”€ ğŸ“„ requirements.md
â”‚        â”œâ”€â”€ ğŸ“„ tasks.md
â”‚      â””â”€â”€ ğŸ“‚ refactor-router-structure/
â”‚        â”œâ”€â”€ ğŸ“„ design.md
â”‚        â”œâ”€â”€ ğŸ“„ requirements.md
â”‚        â”œâ”€â”€ ğŸ“„ tasks.md
â”‚    â””â”€â”€ ğŸ“‚ in-progress/
â”‚      â””â”€â”€ ğŸ“‚ add-students-to-classes/
â”‚        â”œâ”€â”€ ğŸ“„ app-config-update-plan.md
â”‚        â”œâ”€â”€ ğŸ“„ debug-tasks.md
â”‚        â”œâ”€â”€ ğŸ“„ deep-linking-plan.md
â”‚        â”œâ”€â”€ ğŸ“„ design.md
â”‚        â”œâ”€â”€ ğŸ“„ error-boundary-implementation-plan.md
â”‚        â”œâ”€â”€ ğŸ“„ navigation-implementation-plan.md
â”‚        â”œâ”€â”€ ğŸ“„ quality-assessment-report.md
â”‚        â”œâ”€â”€ ğŸ“„ requirements.md
â”‚        â”œâ”€â”€ ğŸ“„ sql-injection-fix.md
â”‚        â”œâ”€â”€ ğŸ“„ tasks.md
â”‚    â””â”€â”€ ğŸ“‚ planned/
â”‚      â””â”€â”€ ğŸ“‚ financial-management-phase1/
â”‚        â”œâ”€â”€ ğŸ“„ design.md
â”‚        â”œâ”€â”€ ğŸ“„ requirements.md
â”‚        â”œâ”€â”€ ğŸ“„ tasks.md
â”‚    â”œâ”€â”€ ğŸ“„ teacher_calendar_spec.md
â”‚  â””â”€â”€ ğŸ“‚ students/
â”‚    â””â”€â”€ ğŸ“‚ features/
â”‚      â”œâ”€â”€ ğŸ“„ prd-add-students-to-classes.md
â”‚      â”œâ”€â”€ ğŸ“„ prd-goal-setting-weekend-focus.md
â”‚    â”œâ”€â”€ ğŸ“„ prd-students-overview.md
â”‚  â””â”€â”€ ğŸ“‚ teachers/
â”‚    â””â”€â”€ ğŸ“‚ features/
â”‚      â”œâ”€â”€ ğŸ“„ prd-class-subject-crud.md
â”‚      â”œâ”€â”€ ğŸ“„ prd-classroom-management.md
â”‚      â”œâ”€â”€ ğŸ“„ prd-subject-management.md
â”‚      â”œâ”€â”€ ğŸ“„ prd-teacher-calendar-schedule.md
â”‚    â”œâ”€â”€ ğŸ“„ prd-teachers-overview.md
â”œâ”€â”€ ğŸ“„ eas.json
â”œâ”€â”€ ğŸ“„ eslint.config.js
â”œâ”€â”€ ğŸ“„ jest.setup.js
â”œâ”€â”€ ğŸ“„ metro.config.js
â”œâ”€â”€ ğŸ“„ package.json
â””â”€â”€ ğŸ“‚ scripts/
â”‚  â””â”€â”€ ğŸ“‚ security/
â”‚    â”œâ”€â”€ ğŸ“„ README.md
â”‚    â”œâ”€â”€ ğŸ“„ audit-auth.js
â”‚    â”œâ”€â”€ ğŸ“„ audit-input.js
â”‚    â”œâ”€â”€ ğŸ“„ audit-logging.js
â”‚    â”œâ”€â”€ ğŸ“„ fix-logging.js
â”‚    â”œâ”€â”€ ğŸ“„ test-fix-logging.js
â””â”€â”€ ğŸ“‚ src/
â”‚  â””â”€â”€ ğŸ“‚ components/
â”‚    â”œâ”€â”€ ğŸ“„ LogoIcon.tsx
â”‚    â””â”€â”€ ğŸ“‚ atoms/
â”‚      â””â”€â”€ ğŸ“‚ Avatar/
â”‚        â”œâ”€â”€ ğŸ“„ Avatar.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Avatar.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Avatar.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ BackgroundPattern/
â”‚        â”œâ”€â”€ ğŸ“„ BackgroundPattern.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ BackgroundPattern.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ BackgroundPattern.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ Button/
â”‚        â”œâ”€â”€ ğŸ“„ Button.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Button.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Button.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ Icon/
â”‚        â”œâ”€â”€ ğŸ“„ Icon.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Icon.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Icon.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ Input/
â”‚        â”œâ”€â”€ ğŸ“„ Input.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Input.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Input.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ LoadingSpinner/
â”‚        â”œâ”€â”€ ğŸ“„ LoadingSpinner.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ LoadingSpinner.tsx
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ Typography/
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ Typography.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Typography.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Typography.tsx
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â”œâ”€â”€ ğŸ“„ index.ts
â”‚    â”œâ”€â”€ ğŸ“„ index.ts
â”‚    â””â”€â”€ ğŸ“‚ molecules/
â”‚      â””â”€â”€ ğŸ“‚ BreadcrumbNavigation/
â”‚        â”œâ”€â”€ ğŸ“„ BreadcrumbNavigation.tsx
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ BulkActionBar/
â”‚        â”œâ”€â”€ ğŸ“„ BulkActionBar.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ BulkActionBar.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ BulkActionBar.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ Card/
â”‚        â”œâ”€â”€ ğŸ“„ Card.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Card.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Card.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ EmptyState/
â”‚        â”œâ”€â”€ ğŸ“„ EmptyState.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ EmptyState.tsx
â”‚      â””â”€â”€ ğŸ“‚ ErrorMessage/
â”‚        â”œâ”€â”€ ğŸ“„ ErrorMessage.tsx
â”‚      â””â”€â”€ ğŸ“‚ ListItem/
â”‚        â”œâ”€â”€ ğŸ“„ ListItem.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ ListItem.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ ListItem.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â”œâ”€â”€ ğŸ“„ LogoutButton.tsx
â”‚      â””â”€â”€ ğŸ“‚ NotificationItem/
â”‚        â”œâ”€â”€ ğŸ“„ NotificationItem.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ NotificationItem.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ NotificationItem.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ ProgressBar/
â”‚        â”œâ”€â”€ ğŸ“„ ProgressBar.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ ProgressBar.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ ProgressBar.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ QuickAction/
â”‚        â”œâ”€â”€ ğŸ“„ QuickAction.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ QuickAction.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ QuickAction.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ SkeletonCard/
â”‚        â”œâ”€â”€ ğŸ“„ SkeletonCard.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ SkeletonCard.tsx
â”‚      â””â”€â”€ ğŸ“‚ StudentSelectionList/
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ StudentSelectionItem.tsx
â”‚        â”œâ”€â”€ ğŸ“„ StudentSelectionList.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ StudentSelectionList.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ StudentSelectionList.tsx
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â”œâ”€â”€ ğŸ“„ index.ts
â”‚    â””â”€â”€ ğŸ“‚ organisms/
â”‚      â””â”€â”€ ğŸ“‚ AddStudentsToClassModal/
â”‚        â”œâ”€â”€ ğŸ“„ AddStudentsToClassModal.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ AddStudentsToClassModal.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ AddStudentsToClassModal.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â”œâ”€â”€ ğŸ“„ AnimatedSplashScreen.tsx
â”‚      â”œâ”€â”€ ğŸ“„ AuthForm.tsx
â”‚      â”œâ”€â”€ ğŸ“„ ClassFormModal.tsx
â”‚      â””â”€â”€ ğŸ“‚ DashboardContent/
â”‚        â”œâ”€â”€ ğŸ“„ DashboardContent.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ ErrorBoundary/
â”‚        â”œâ”€â”€ ğŸ“„ ErrorBoundary.tsx
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ Header/
â”‚        â”œâ”€â”€ ğŸ“„ Header.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Header.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Header.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ Modal/
â”‚        â”œâ”€â”€ ğŸ“„ Modal.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Modal.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ Modal.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ NavigationPanel/
â”‚        â”œâ”€â”€ ğŸ“„ NavigationPanel.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ NavigationPanel.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ NavigationPanel.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â”œâ”€â”€ ğŸ“„ StudentBoardingInfoModal.tsx
â”‚      â”œâ”€â”€ ğŸ“„ StudentCommunicationModal.tsx
â”‚      â”œâ”€â”€ ğŸ“„ StudentIncidentReportModal.tsx
â”‚      â”œâ”€â”€ ğŸ“„ SubjectManager.tsx
â”‚      â””â”€â”€ ğŸ“‚ TabBar/
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ TabBar.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ TabBar.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ TabBar.tsx
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â”œâ”€â”€ ğŸ“„ TeacherBoardingInfoModal.tsx
â”‚      â”œâ”€â”€ ğŸ“„ TeacherCommunicationModal.tsx
â”‚      â”œâ”€â”€ ğŸ“„ TeacherIncidentReportModal.tsx
â”‚      â”œâ”€â”€ ğŸ“„ TeacherNotificationPanel.tsx
â”‚      â”œâ”€â”€ ğŸ“„ TeacherProfileView.tsx
â”‚      â”œâ”€â”€ ğŸ“„ index.ts
â”‚    â””â”€â”€ ğŸ“‚ templates/
â”‚      â”œâ”€â”€ ğŸ“„ AddStudentTemplate.tsx
â”‚      â”œâ”€â”€ ğŸ“„ AntiBullyingResourcesTemplate.tsx
â”‚      â”œâ”€â”€ ğŸ“„ CCTVAccessRequestTemplate.tsx
â”‚      â”œâ”€â”€ ğŸ“„ ClassDetailTemplate.tsx
â”‚      â”œâ”€â”€ ğŸ“„ ClassDetailView.tsx
â”‚      â”œâ”€â”€ ğŸ“„ ClassReportsTemplate.tsx
â”‚      â”œâ”€â”€ ğŸ“„ ClassScheduleTemplate.tsx
â”‚      â”œâ”€â”€ ğŸ“„ ClassStudentsTemplate.tsx
â”‚      â”œâ”€â”€ ğŸ“„ ClassesListTemplate.tsx
â”‚      â””â”€â”€ ğŸ“‚ DashboardTemplate/
â”‚        â”œâ”€â”€ ğŸ“„ DashboardTemplate.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ DashboardTemplate.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ DashboardTemplate.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ FormTemplate/
â”‚        â”œâ”€â”€ ğŸ“„ FormTemplate.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ FormTemplate.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ FormTemplate.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â””â”€â”€ ğŸ“‚ ModalTemplate/
â”‚        â”œâ”€â”€ ğŸ“„ ModalTemplate.stories.tsx
â”‚        â”œâ”€â”€ ğŸ“„ ModalTemplate.test.tsx
â”‚        â”œâ”€â”€ ğŸ“„ ModalTemplate.tsx
â”‚        â”œâ”€â”€ ğŸ“„ README.md
â”‚        â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â”œâ”€â”€ ğŸ“„ ParentIncidentReportTemplate.tsx
â”‚      â”œâ”€â”€ ğŸ“„ StudentAntiBullyingTemplate.tsx
â”‚      â”œâ”€â”€ ğŸ“„ StudentDetailTemplate.tsx
â”‚      â”œâ”€â”€ ğŸ“„ StudentIncidentReportTemplate.tsx
â”‚      â”œâ”€â”€ ğŸ“„ StudentsListTemplate.tsx
â”‚      â”œâ”€â”€ ğŸ“„ index.ts
â”‚  â””â”€â”€ ğŸ“‚ context/
â”‚    â”œâ”€â”€ ğŸ“„ NavigationHistoryContext.tsx
â”‚    â”œâ”€â”€ ğŸ“„ ThemeContext.tsx
â”‚    â””â”€â”€ ğŸ“‚ __tests__/
â”‚      â”œâ”€â”€ ğŸ“„ NavigationHistoryContext.test.tsx
â”‚    â”œâ”€â”€ ğŸ“„ index.ts
â”‚  â””â”€â”€ ğŸ“‚ hooks/
â”‚    â”œâ”€â”€ ğŸ“„ README.md
â”‚    â”œâ”€â”€ ğŸ“„ index.ts
â”‚    â”œâ”€â”€ ğŸ“„ useAuth.ts
â”‚    â”œâ”€â”€ ğŸ“„ useClassStudentBreakdown.ts
â”‚    â”œâ”€â”€ ğŸ“„ useClassStudentsSubscription.ts
â”‚    â”œâ”€â”€ ğŸ“„ useNavigationGuards.ts
â”‚    â”œâ”€â”€ ğŸ“„ useNavigationHistory.ts
â”‚    â”œâ”€â”€ ğŸ“„ useStudentCountSubscription.ts
â”‚  â””â”€â”€ ğŸ“‚ mocks/
â”‚    â”œâ”€â”€ ğŸ“„ classData.ts
â”‚  â””â”€â”€ ğŸ“‚ services/
â”‚    â””â”€â”€ ğŸ“‚ __tests__/
â”‚      â”œâ”€â”€ ğŸ“„ README.md
â”‚      â”œâ”€â”€ ğŸ“„ classService.security.test.ts
â”‚      â”œâ”€â”€ ğŸ“„ classService.simple.test.ts
â”‚      â”œâ”€â”€ ğŸ“„ classService.test.ts
â”‚      â”œâ”€â”€ ğŸ“„ integration.test.ts
â”‚      â”œâ”€â”€ ğŸ“„ runTests.ts
â”‚      â”œâ”€â”€ ğŸ“„ test-report.json
â”‚      â”œâ”€â”€ ğŸ“„ test-report.md
â”‚      â”œâ”€â”€ ğŸ“„ testHelpers.ts
â”‚      â”œâ”€â”€ ğŸ“„ verify-completion.ts
â”‚    â””â”€â”€ ğŸ“‚ class/
â”‚      â””â”€â”€ ğŸ“‚ __tests__/
â”‚        â”œâ”€â”€ ğŸ“„ access.test.ts
â”‚        â”œâ”€â”€ ğŸ“„ enrollment.test.ts
â”‚      â”œâ”€â”€ ğŸ“„ access.ts
â”‚      â”œâ”€â”€ ğŸ“„ audit.ts
â”‚      â”œâ”€â”€ ğŸ“„ bulk.ts
â”‚      â”œâ”€â”€ ğŸ“„ enrollment.ts
â”‚      â”œâ”€â”€ ğŸ“„ index.ts
â”‚      â”œâ”€â”€ ğŸ“„ repository.ts
â”‚      â”œâ”€â”€ ğŸ“„ types.ts
â”‚    â”œâ”€â”€ ğŸ“„ classService.ts
â”‚    â”œâ”€â”€ ğŸ“„ dashboard.ts
â”‚    â”œâ”€â”€ ğŸ“„ incidents.ts
â”‚    â”œâ”€â”€ ğŸ“„ schools.ts
â”‚    â”œâ”€â”€ ğŸ“„ subjectService.ts
â”‚    â”œâ”€â”€ ğŸ“„ users.ts
â”‚  â””â”€â”€ ğŸ“‚ stores/
â”‚    â”œâ”€â”€ ğŸ“„ authStore.ts
â”‚    â”œâ”€â”€ ğŸ“„ index.ts
â”‚  â””â”€â”€ ğŸ“‚ styles/
â”‚    â”œâ”€â”€ ğŸ“„ colors.ts
â”‚    â”œâ”€â”€ ğŸ“„ shadows.ts
â”‚    â”œâ”€â”€ ğŸ“„ spacing.ts
â”‚    â”œâ”€â”€ ğŸ“„ theme.ts
â”‚    â”œâ”€â”€ ğŸ“„ typography.ts
â”‚  â””â”€â”€ ğŸ“‚ types/
â”‚    â”œâ”€â”€ ğŸ“„ class.ts
â”‚    â”œâ”€â”€ ğŸ“„ dashboard.ts
â”‚    â”œâ”€â”€ ğŸ“„ database.ts
â”‚    â”œâ”€â”€ ğŸ“„ exports.ts
â”‚    â”œâ”€â”€ ğŸ“„ index.ts
â”‚    â”œâ”€â”€ ğŸ“„ student.ts
â”‚  â””â”€â”€ ğŸ“‚ utils/
â”‚    â””â”€â”€ ğŸ“‚ __tests__/
â”‚      â”œâ”€â”€ ğŸ“„ deep-linking.test.ts
â”‚      â”œâ”€â”€ ğŸ“„ retry-debug.test.ts
â”‚      â”œâ”€â”€ ğŸ“„ retry.test.ts
â”‚      â”œâ”€â”€ ğŸ“„ sanitization.test.ts
â”‚    â”œâ”€â”€ ğŸ“„ backgroundPattern.ts
â”‚    â”œâ”€â”€ ğŸ“„ dateHelpers.ts
â”‚    â”œâ”€â”€ ğŸ“„ idConversion.ts
â”‚    â”œâ”€â”€ ğŸ“„ linking.ts
â”‚    â”œâ”€â”€ ğŸ“„ logger.ts
â”‚    â”œâ”€â”€ ğŸ“„ navigationGuard.ts
â”‚    â”œâ”€â”€ ğŸ“„ responsive.ts
â”‚    â”œâ”€â”€ ğŸ“„ retry.ts
â”‚    â”œâ”€â”€ ğŸ“„ sanitization.ts
â”‚    â”œâ”€â”€ ğŸ“„ styleHelpers.ts
â”‚    â”œâ”€â”€ ğŸ“„ supabase.ts
â”‚    â”œâ”€â”€ ğŸ“„ svgPatterns.ts
â”‚    â”œâ”€â”€ ğŸ“„ typeHelpers.ts
â””â”€â”€ ğŸ“‚ supabase/
â”‚  â””â”€â”€ ğŸ“‚ tests/
â”‚    â”œâ”€â”€ ğŸ“„ schema-polish-tests.sql
â”œâ”€â”€ ğŸ“„ test_atomic_enrollment.ts
â””â”€â”€ ğŸ“„ tsconfig.json
```

## Target Codebase Structure

### Architecture Overview

- UI Components: Atomic design pattern (atoms â†’ molecules â†’ organisms)
- Domains: Business logic separated from UI concerns
- Context: React context providers for global state
- Lib: Shared utilities, hooks, and helpers
- Testing: Unit, integration, e2e, and Storybook stories
- Feature Slices: Each feature contains screen, model, ui, store, tests

```
MadraXis
+-- app                            # Expo Router surface
|   +-- _layout.tsx
|   +-- (auth)
|   |   +-- _layout.tsx
|   |   +-- login
|   |   |   +-- screen.tsx
|   |   |   +-- model.ts
|   |   |   +-- ui.tsx
|   |   |   +-- store.ts                     # local Zustand store
|   |   |   +-- Login.integration.test.tsx
|   |   |   +-- Login.stories.tsx
|   |   |   +-- Login.md
|   |   |   +-- index.ts                     # barrel for cleaner imports
|   |   +-- reset-password
|   |       ...                              # same pattern as login
|   |
|   +-- (student)
|   |   +-- dashboard
|   |   |   +-- screen.tsx
|   |   |   +-- widgets
|   |   |   |   +-- ScoreCard.tsx
|   |   |   |   +-- ScoreCard.test.tsx
|   |   |   |   +-- ScoreCard.stories.tsx
|   |   |   +-- Dashboard.integration.test.tsx
|   |   |   +-- index.ts
|   |   +-- quran-progress
|   |       ...                              # same pattern
|   |
|   +-- (teacher)
|       +-- class
|           +-- [id]
|               +-- add-students
|               |   +-- screen.tsx
|               |   +-- model.ts
|               |   +-- ui.tsx
|               |   +-- store.ts
|               |   +-- AddStudents.integration.test.tsx
|               |   +-- AddStudents.e2e.spec.ts
|               |   +-- index.ts
|               +-- schedule
|               |   ...                      # schedule feature
|               +-- reports
|                   ...                      # reports feature
|
+-- src
|   +-- ui                                   # pure, role-agnostic visual kit
|   |   +-- atoms
|   |   |   +-- Button
|   |   |   |   +-- Button.tsx
|   |   |   |   +-- Button.test.tsx
|   |   |   |   +-- Button.stories.tsx
|   |   |   |   +-- README.md
|   |   |   |   +-- index.ts
|   |   |   +-- Avatar
|   |   |       ...                          # same layout
|   |   +-- molecules
|   |   |   +-- Card
|   |   |       ...                          # files as above
|   |   +-- organisms
|   |   |   +-- Header
|   |   |       ...
|   |   +-- index.ts                         # exports everything from ui/*
|   |
|   +-- domains                              # business logic, no RN imports
|   |   +-- class
|   |   |   +-- api.ts
|   |   |   +-- hooks.ts
|   |   |   +-- store.ts                     # global class state (zustand)
|   |   |   +-- types.ts
|   |   |   +-- Class.unit.test.ts
|   |   |   +-- index.ts
|   |   +-- incidents
|   |   |   +-- api.ts
|   |   |   +-- hooks.ts
|   |   |   +-- types.ts
|   |   |   +-- index.ts
|   |   +-- subjects
|   |   +-- users
|   |
|   +-- lib                                  # cross-cutting helpers
|   |   +-- hooks
|   |   |   +-- usePrevious.ts
|   |   |   +-- useDebounce.ts
|   |   +-- utils
|   |   |   +-- logger.ts
|   |   |   +-- date.ts
|   |   +-- constants
|   |   |   +-- roleCapabilities.ts          # single source of RBAC truth
|   |   +-- tests
|   |       +-- renderWithProviders.tsx
|   |       +-- navigationMock.ts
|   |
|   +-- context
|   |   +-- AuthContext
|   |   |   +-- AuthProvider.tsx
|   |   |   +-- useAuth.ts
|   |   |   +-- AuthContext.test.tsx
|   |   |   +-- index.ts
|   |   +-- ThemeContext
|   |       ...
|   |
|   +-- types                                # global TS declarations
|       +-- index.ts
|
+-- .storybook
|   +-- main.js
|   +-- preview.js
|
+-- jest
|   +-- setup.ts
|   +-- mocks
|       +-- fileMock.js
|       +-- svgMock.js
|
+-- e2e                                      # Detox / Playwright specs
|   +-- add-students-flow.spec.ts
|
+-- assets                                   # fonts, images, animations
+-- scripts                                  # automation / security / build
|
+-- metro.config.js
+-- tsconfig.json                            # path aliases for @ui, @domains, â€¦
+-- jest.config.ts
+-- .eslintrc.js
+-- prettier.config.js
+-- package.json
+-- README.md
```

## Migration Strategy

### Migration Phases

The refactoring will be executed in 6 carefully planned phases:

#### Phase 1: Infrastructure Setup
- Configure path aliases in `tsconfig.json` and `jest.config.ts`
- Set up Storybook and E2E testing frameworks
- Create migration automation scripts
- **Checkpoint**: Validate path aliases and tooling setup (including test compilation)

#### Phase 2: Parallel Structure Creation
- Create new directory structures alongside existing ones
- Set up barrel exports for backward compatibility
- Implement dual import system
- **Checkpoint**: Validate parallel structure and dual imports

#### Phase 3: UI Component Migration
- Migrate components from `src/components/` to `src/ui/`
- Update imports using automation scripts
- Maintain backward compatibility during transition
- **Checkpoint**: Validate component migration and imports

#### Phase 4: Domain Migration
- Create domain modules and migrate from `src/services/`
- Migrate stores to appropriate contexts/domains
- Update business logic imports
- **Checkpoint**: Validate domain structure and service replacement

#### Phase 5: Feature Slice Migration
- Convert flat route files to feature directories
- Implement feature-specific patterns
- Update routing and navigation
- **Checkpoint**: Validate feature slices and routing

#### Phase 6: Cleanup and Validation
- Remove old directory structures
- Final validation and performance testing
- Documentation updates
- **Checkpoint**: Migration completion validation

### Migration Automation

#### Import Update Scripts
```bash
# scripts/migration/update-imports.js
# Automatically updates import paths from old to new structure
node scripts/migration/update-imports.js --phase=ui-components
node scripts/migration/update-imports.js --phase=domains
node scripts/migration/update-imports.js --phase=lib
```

#### Validation Scripts
```bash
# scripts/migration/validate-imports.js
# Validates all imports are working after migration phase
node scripts/migration/validate-imports.js --check-broken-imports
node scripts/migration/validate-imports.js --check-unused-exports
```

#### Rollback Scripts
```bash
# scripts/migration/rollback.js
# Rollback to previous migration phase if issues occur
node scripts/migration/rollback.js --to-phase=2
node scripts/migration/rollback.js --to-checkpoint=ui-components
```

### Store Migration Strategy

#### Current State
```typescript
// src/stores/authStore.ts - Zustand store with persistence
export const useAuthStore = create(
  persist(
    (set) => ({
      session: null,
      user: null,
      // ... auth logic
    }),
    {
      name: 'auth-storage',
      storage: createJSONStorage(() => AsyncStorage),
    }
  )
);
```

#### Target State
```typescript
// src/context/AuthContext/AuthProvider.tsx - React Context with persistence
import AsyncStorage from '@react-native-async-storage/async-storage';

export const AuthProvider = ({ children }) => {
  const [authState, dispatch] = useReducer(authReducer, initialState);

  // Preserve persistence behavior from Zustand
  useEffect(() => {
    // Hydrate auth state on app startup
    const loadPersistedAuth = async () => {
      try {
        const persistedAuth = await AsyncStorage.getItem('auth-storage');
        if (persistedAuth) {
          dispatch({ type: 'HYDRATE', payload: JSON.parse(persistedAuth) });
        }
      } catch (error) {
        console.error('Failed to load persisted auth:', error);
      }
    };

    loadPersistedAuth();
  }, []);

  // Persist auth state changes
  useEffect(() => {
    const persistAuth = async () => {
      try {
        await AsyncStorage.setItem('auth-storage', JSON.stringify(authState));
      } catch (error) {
        console.error('Failed to persist auth:', error);
      }
    };

    if (authState.session || authState.user) {
      persistAuth();
    }
  }, [authState]);

  // ... rest of auth logic
};

// src/domains/class/store.ts - Domain-specific Zustand store
export const useClassStore = create((set) => ({
  classes: [],
  selectedClass: null,
  // ... class-specific state
}));
```

#### Migration Rules
1. **Global State** â†’ React Context (auth, theme, navigation)
2. **Auth Persistence** â†’ Replicate Zustand persist behavior with AsyncStorage and proper hydration
3. **Domain State** â†’ Domain-specific Zustand stores
4. **Feature State** â†’ Local Zustand stores in feature directories
5. **Maintain Interfaces** â†’ Keep existing hook interfaces during transition
6. **Session Continuity** â†’ Ensure users remain logged in across app restarts and reloads