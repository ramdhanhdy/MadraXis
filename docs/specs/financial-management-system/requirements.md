# Financial Management System Requirements

## Introduction

This specification defines the requirements for a basic financial management system in the MadraXis school application. The system focuses on manual expense tracking by categories (e.g., salaries, supplies, utilities), setting monthly budget limits, and simple dashboards to visualize spending against budgets. It aims to replace inefficient paper/Excel processes with a structured, digital solution accessible to school management. The feature will integrate with the existing management dashboard and adhere to the consistent design system.

## Functional Requirements

| ID       | User Story                                                                                                         | Acceptance Criteria                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| -------- | ------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **FR-1** | As a school manager I want to **log an expense in < 30 s** so that I can keep up-to-date records between classes.  | 1. A **floating action button (FAB)** on the Finance Hub opens a **bottom-sheet modal** whose first state is "Log Expense".<br>2. The form fields are **Category**, **Amount**, **Date**, **Description**, **Notes**, **Receipt (camera)**.<br>3. **Defaults**: Category is pre-selected via ML on description after 3 characters; Amount is auto-filled from clipboard if numeric; Date defaults to Today via swipeable chips.<br>4. **Validation**: Amount must be > 0; error appears inline.<br>5. **Submission** is **optimistic**: UI animates the budget progress ring **within 200 ms**; offline writes queue locally and sync automatically. |
| **FR-2** | As a school manager I want to **adjust monthly category budgets** quickly so that I can react to unexpected costs. | 1. The same bottom-sheet modal contains a second tab "Adjust Budget".<br>2. Each category shows its **current limit**, **spent-to-date**, and a **slider (-10 % / +10 %)** plus numeric input fallback.<br>3. Changes are **persisted immediately** and reflected in the live progress ring.<br>4. **Archive / un-archive** toggle is available per category.                                                                                                                                                                                                                                                                                        |
| **FR-3** | As a school manager I want to **see budget health at a glance** so that I know when to stop spending.              | 1. A **radial progress ring card** on the Finance Hub shows **spent vs limit** for the selected category or "All".<br>2. Ring colour rules: **Green > 20 % left**, **Amber 5–20 %**, **Red ≤ 5 %** (pulses every 2 s).<br>3. **Micro-copy** beneath ring: "$60 left • 9 days to Aug".<br>4. **Swipe left on any expense row** reveals "Duplicate" action for recurring items.                                                                                                                                                                                                                                                                                       |
| **FR-4** | As a school manager I want to **filter / search expenses** without leaving the screen.                             | 1. A **search bar + chips** (Today / Yesterday / This Week / Category) appear at top of Finance Hub.<br>2. Results update **live**; skeleton placeholders shown while fetching.                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **FR-5** | As a school manager I want **empty & loading states** that guide me.                                               | 1. **Empty state**: illustration + "Log your first expense to light up the dashboard."<br>2. **Skeletons** mirror exact layout to prevent layout shift.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **FR-6** | As a developer I want **secure, consistent integration**.                                                          | 1. **RLS** enforces `auth.uid() = management` and `school_id` match.<br>2. **Check constraint**: `amount > 0`.<br>3. All UI uses existing **design-system tokens** (buttons, cards, typography).<br>4. Errors handled by global `ErrorBoundary` with copy "Something went wrong – please try again."                                                                                                                                                                                                                                                                                                                                                 |